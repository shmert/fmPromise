/** Create an error payload suitable for returning from your script which is called from fmPromise.
 * This error will be treated as a promise rejection in the web viewer JavaScript.
 * if errorCode is empty, Get(LastError) will be used, or -1 if there is no last error.
 * Any fmPromise script result beginning with "Error: " is treated as a rejected promise by fmPromise
 */

"Error: " &
JSONSetElement ( "" ;
  [ "code" ; Case ( not IsEmpty ( errorCode ) ; errorCode ; Get ( LastError ) ; Get ( LastError ) ; -1 ) ; JSONNumber ] ;
  [ "message" ; message ; JSONString ] ;
  [ "script" ; Get ( ScriptName ) ; JSONString ]
)
